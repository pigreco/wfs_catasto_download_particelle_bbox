# This file contains metadata for your plugin.

# This file should be included when you package your plugin.# Mandatory items:

[general]
name=WFS Catasto Download Particelle BBox
qgisMinimumVersion=3.0
description=Download particelle catastali dal WFS dell'Agenzia delle Entrate tramite BBox, selezione poligono, linea con buffer o layer di punti.
version=1.5.1
author=Salvatore Fiandaca
email=pigrecoinfinito@gmail.com

about=WFS Catasto Download Particelle BBox - Plugin per QGIS che consente di scaricare le particelle catastali dal servizio WFS dell'Agenzia delle Entrate (INSPIRE).
    Quattro modalita' di selezione dell'area di interesse:
    1) Disegna BBox: clicca due punti sulla mappa per disegnare un rettangolo di download.
    2) Seleziona Poligono: clicca su un poligono esistente per estrarne il bounding box.
    3) Seleziona Linea: clicca su una linea e crea un buffer personalizzabile (0-100m) per scaricare le particelle che lo intersecano.
    4) Seleziona Punti: clicca su un layer di punti (o direttamente in mappa) per scaricare le particelle che contengono i punti. Supporta selezione parziale e auto-riproiezione UTM per CRS geografici.
    Opzione "Espandi riferimento catastale": estrae dal campo NATIONALCADASTRALREFERENCE i campi sezione, foglio, allegato e sviluppo (formato CCCCZFFFFAS).
    Supporta download multi-tile con progress bar, deduplicazione feature e filtro spaziale. Compatibile con QGIS 3 (Qt5) e QGIS 4 (Qt6).
    ---
    EN: A QGIS plugin for downloading cadastral parcels from the Italian Revenue Agency (Agenzia delle Entrate) WFS INSPIRE service. Three selection modes: draw BBox, select polygon, select line with customizable buffer (0-100m). Optional expansion of NATIONALCADASTRALREFERENCE into section, sheet, attachment and development fields. Supports multi-tile download with progress bar, feature deduplication and spatial filtering.
    DISCLAIMER: Please use this plugin responsibly. Massive or repeated downloads may overload the WFS service of the Italian Revenue Agency, causing disruptions for all users.

tracker=https://github.com/pigreco/wfs_catasto_download_particelle_bbox/issues
repository=https://github.com/pigreco/wfs_catasto_download_particelle_bbox
# End of mandatory metadata

# Recommended items:

hasProcessingProvider=no
changelog=
    1.5.1 - Fix: rimossa combo "Aggiungi a" locale dalla riga Seleziona Punti
            (issue #9): il controllo OUTPUT globale e' ora l'unico punto per
            scegliere il layer di destinazione, valido per tutte le modalita'.
            Fix compatibilita' Qt6: QMessageBox.Yes/No sostituiti con
            QMessageBox.StandardButton.Yes/No tramite costanti _MB_Yes/_MB_No
            nel blocco di compatibilita' Qt5/Qt6.
    1.5.0 - Output Unificato: nuovo checkbox + combo "Output" per accodare i risultati
            di qualsiasi modalita' (BBox, Poligono, Linea, Punti) a un layer Particelle
            WFS esistente. Il controllo globale sostituisce il precedente "Aggiungi a"
            locale della sola modalita' Punti, ora visibile solo quando Output Unificato
            non e' attivo. GUI completamente ridisegnata: layout compatto a lista
            verticale con separatori, bottoni di larghezza fissa, descrizioni brevi
            inline. Fix crash KeyError '-1' quando "Espandi riferimento catastale" e'
            attivo in modalita' append su un layer privo dei campi catastali: il plugin
            mostra ora un avviso con scelta Si'/No prima di procedere.
    1.4.11 - Fix logica 'Seleziona Punti': separazione netta tra le due modalita'.
             Sorgente=(clicca sulla mappa): SOLO download singola particella per
             ogni click (modalita' sessione, ESC per terminare). Rimossa la
             rilevazione automatica di layer punti vicini al click, ora gestita
             esclusivamente dalla combo Sorgente.
             Sorgente=layer specifico: processing automatico all'avvio, nessun
             click interattivo. Refactoring _processa_layer_punti con try/finally
             per garantire chiusura tool e riapertura dialogo anche in caso di errore.
             Migliorato messaggio di errore "Nessuna feature" con suggerimento per
             punti in mare o fuori copertura catastale.
    1.4.10 - Fix: combo "Sorgente" si azzera sempre a "(clicca sulla mappa)" alla
             riapertura del dialogo (non ripristina piu' la selezione precedente).
             Fix: aggiunto showFeatureCount sul layer di destinazione in modalita'
             append, e notifica nella barra messaggi QGIS con il conteggio
             delle particelle aggiunte/caricate (sia per nuovo layer che per append).
    1.4.9 - Modalita' Seleziona Punti: nuova combo "Sorgente" per scegliere un layer
            di punti direttamente dal dialogo (senza dover cliccare in mappa).
            Nuova combo "Aggiungi a" per aggiungere le particelle a un layer
            Particelle WFS esistente invece di crearne uno nuovo.
            Copertura completa degli scenari 2/3/4 richiesti nell'issue #6.
    1.4.8 - Modalita' Seleziona Punti: click singolo con accumulo feature nello
            stesso layer di sessione (append invece di creare un layer per ogni click).
            Deduplicazione cross-click per gml_id. ESC per terminare la sessione
            (implementato con QShortcut per affidabilita' dopo dialoghi modali).
            Rimossa sezione changelog dalla guida online.
    1.4.7 - Miglioramenti interfaccia: Riorganizzato layout bottoni con "Chiudi"
            a sinistra (3/4 spazio) e "Guida" a destra (1/4 spazio).
            Aggiunta voce "Guida" nel menu Plugin dopo "Informazioni".
            Migliorata accessibilita' e proporzioni dei controlli dell'interfaccia.
    1.4.6 - Sistema help integrato con GitHub Pages: bottone "Aiuto" nell'interfaccia
            che apre documentazione online completa con guida d'uso dettagliata.
            Documentazione responsive con navigazione interna, troubleshooting e
            sezioni dettagliate per ogni modalita' del plugin.
    1.4.5 - Aggiunto sottomenu nel menu Plugin con "Avvia Download Particelle Catastali" 
            e "Informazioni". Dialog AboutDialog con informazioni complete del plugin,
            link GitHub autore, riferimenti WFS/WMS e documentazione ufficiale.
            Fix compatibilita' Qt5/Qt6 per exec_() vs exec(). Formattazione migliorata.
    1.4.4 - Stile automatico rule-based per il layer particelle: arancione per particelle
            numeriche, grigio per strade (STRADA), blu per acque (ACQUA).
            Conteggio feature per categoria visibile in legenda.
    1.4.3 - Opzione per caricare il WMS Cartografia Catastale dell'Agenzia delle Entrate
            (province, mappe, acque, strade, vestizioni, fabbricati, particelle).
            Connessione WMS aggiunta automaticamente al profilo QGIS se non presente.
            Layer posizionato sopra eventuali basemap XYZ (es. OpenStreetMap).
            Versione plugin visualizzata nel titolo della finestra di dialogo.
    1.4.2 - Nuova funzione per il calcolatore di campi: get_particella_info($geometry)
            nel gruppo 'Catasto'. Restituisce un array con riferimento catastale,
            foglio, label, codice comune, geometria WKT, sezione e allegato
            dalla particella WFS sottostante al punto.
    1.4.1 - Modalita' Seleziona Linea: possibilita' di disegnare una polilinea
            direttamente sulla mappa (click sinistro per aggiungere vertici,
            click destro per terminare, ESC per annullare).
            Titolo GUI con licenza CC-BY 4.0 cliccabile.
            Link cliccabili nella finestra di avviso.
            Fix: la finestra di dialogo non rimane piu' in primo piano
            su applicazioni esterne a QGIS.
    1.4.0 - Nuova modalita' Seleziona Punti: scarica particelle da layer di punti
            (selezionati o tutti) con buffer, dissolve e filtro point-in-polygon.
            Fallback click libero per scaricare la particella sotto il cursore.
            Auto-riproiezione UTM per layer con CRS geografico.
            GUI ristrutturata in griglia 2x2 con parametri Snap e Buffer.
            Aggiunto tasto ESC per annullare qualsiasi modalita'.
    1.3.0 - Aggiunta illustrazioni SVG nella finestra di scelta modalità
            per ogni gruppo (BBox, Poligono, Linea). Layout ottimizzato
            con immagini affiancate. Icona plugin aggiornata a SVG.
    1.2.0 - Ottimizzazione modalità Poligono: filtra i tile e le feature
            che intersecano realmente il poligono selezionato, evitando
            download inutili su bbox rettangolari di poligoni irregolari.
    1.1.0 - Aggiunta opzione "Espandi riferimento catastale" che estrae
            dal campo NATIONALCADASTRALREFERENCE i campi: sezione, foglio,
            allegato e sviluppo (formato CCCCZFFFFAS dell'Agenzia delle Entrate).
    1.0.0 - Prima release: download particelle WFS con tre modalità
            (BBox, Poligono, Linea con buffer), deduplicazione e filtro spaziale.

# Tags are comma separated with spaces allowed
tags=catasto, wfs, particelle, bbox, agenzia entrate, cadastral, inspire, buffer, download

homepage=https://github.com/pigreco/wfs_catasto_download_particelle_bbox
category=Vector
icon=icon.svg
# Qt6 support (QGIS 4)
supportsQt6=yes

# experimental flag
experimental=False

# deprecated flag (applies to the whole plugin, not just a single version)
deprecated=False

# Since QGIS 3.8, a comma separated list of plugins to be installed
# (or upgraded) can be specified.
# Check the documentation for more information.
# plugin_dependencies=

# If the plugin can run on QGIS Server.
server=False

# Plugin realizzato con Claude AI
